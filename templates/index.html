<!DOCTYPE html>
<html lang="tr" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PredictaPRO - CanlÄ±</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: {
                        dark: '#0f172a',
                        card: '#1e293b',
                        gold: '#fbbf24',
                    }
                }
            }
        }
    </script>
    <style>
        [x-cloak] { display: none !important; }
    </style>
</head>
<body class="bg-dark text-slate-300 antialiased">

    <div x-data="app()" x-init="loadMatches()" class="max-w-4xl mx-auto p-4 md:p-8">
        
        <!-- HEADER -->
        <div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4 border-b border-white/10 pb-6">
            <div>
                <h1 class="text-3xl md:text-4xl font-bold text-white tracking-tight">
                    PREDICTA<span class="text-gold">PRO</span>
                </h1>
                <p class="text-slate-400 text-sm mt-2">CanlÄ± MaÃ§ Tahminleri</p>
            </div>
            
            <div class="flex gap-2 w-full md:w-auto">
                <button @click="loadMatches()" class="px-4 py-2 text-sm font-bold bg-gold text-dark hover:bg-yellow-400 rounded-lg transition flex-1 md:flex-none">
                    ðŸ”„ Yenile
                </button>
            </div>
        </div>

        <!-- MAÃ‡LAR -->
        <div class="space-y-5" id="match-list">
            <div class="h-40 bg-card rounded-lg animate-pulse"></div>
            <div class="h-40 bg-card rounded-lg animate-pulse"></div>
        </div>

    </div>

    <script>
        function app() {
            return {
                matches: [],
                
                async loadMatches() {
                    try {
                        const response = await fetch("/api/matches/live");
                        const data = await response.json();
                        this.renderMatches(data.matches || []);
                        setTimeout(() => this.loadMatches(), 10000);
                    } catch (e) {
                        console.error(e);
                    }
                },

                renderMatches(matches) {
                    const container = document.getElementById("match-list");
                    container.innerHTML = "";

                    if (!matches.length) {
                        container.innerHTML = '<div class="text-center py-10 text-slate-500">MaÃ§ bulunamadÄ±.</div>';
                        return;
                    }

                    matches.forEach(match => {
                        const p = match.prediction?.probs || {};
                        
                        const html = `
                            <div class="bg-card border border-white/10 rounded-xl p-6 shadow-lg hover:border-white/20 transition-all">
                                <!-- Ãœst Bilgi -->
                                <div class="flex justify-between items-center text-xs font-bold text-slate-400 uppercase mb-4">
                                    <span>${match.league}</span>
                                    <span>${match.date}</span>
                                </div>

                                <!-- TakÄ±mlar -->
                                <div class="flex justify-between items-center mb-6 pb-4 border-b border-white/5">
                                    <span class="text-lg font-bold text-white">${match.home}</span>
                                    <span class="text-xs text-slate-500 font-bold">vs</span>
                                    <span class="text-lg font-bold text-white">${match.away}</span>
                                </div>

                                <!-- Analiz BarlarÄ± -->
                                <div class="space-y-3 mb-6">
                                    <!-- MS 1 -->
                                    <div>
                                        <div class="flex justify-between mb-1 text-xs">
                                            <span class="text-slate-400">MS 1</span>
                                            <span class="font-bold text-white">%${Math.round(p["1"] || 0)}</span>
                                        </div>
                                        <div class="h-2 bg-slate-800 rounded-full overflow-hidden">
                                            <div class="h-full bg-emerald-500" style="width: ${p["1"] || 0}%"></div>
                                        </div>
                                    </div>

                                    <!-- 2.5 ÃœST -->
                                    <div>
                                        <div class="flex justify-between mb-1 text-xs">
                                            <span class="text-slate-400">Ãœst 2.5</span>
                                            <span class="font-bold text-white">%${Math.round(p["over"] || 0)}</span>
                                        </div>
                                        <div class="h-2 bg-slate-800 rounded-full overflow-hidden">
                                            <div class="h-full bg-gold" style="width: ${p["over"] || 0}%"></div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Ä°statistik KutularÄ± -->
                                <div class="grid grid-cols-2 gap-3 mb-6">
                                    <div class="bg-slate-800/50 rounded-lg p-3 border border-white/5">
                                        <div class="text-xs text-slate-400 mb-1">KG Var</div>
                                        <div class="text-lg font-bold text-gold">%${Math.round(p["btts_yes"] || 0)}</div>
                                    </div>
                                    <div class="bg-slate-800/50 rounded-lg p-3 border border-white/5">
                                        <div class="text-xs text-slate-400 mb-1">KG Yok</div>
                                        <div class="text-lg font-bold text-gold">%${Math.round(p["btts_no"] || 0)}</div>
                                    </div>
                                    <div class="bg-slate-800/50 rounded-lg p-3 border border-white/5">
                                        <div class="text-xs text-slate-400 mb-1">Alt 2.5</div>
                                        <div class="text-lg font-bold text-gold">%${Math.round(p["under"] || 0)}</div>
                                    </div>
                                    <div class="bg-slate-800/50 rounded-lg p-3 border border-white/5">
                                        <div class="text-xs text-slate-400 mb-1">Ãœst 2.5</div>
                                        <div class="text-lg font-bold text-gold">%${Math.round(p["over"] || 0)}</div>
                                    </div>
                                </div>

                                <!-- Oranlar -->
                                <div class="grid grid-cols-3 gap-2 pt-4 border-t border-white/5">
                                    <div class="text-center">
                                        <div class="text-xs text-slate-400 mb-1">MS 1</div>
                                        <div class="text-lg font-bold text-gold">${match.odds["1"] || '-'}</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-xs text-slate-400 mb-1">BERABERLÄ°K</div>
                                        <div class="text-lg font-bold text-white">${match.odds["X"] || '-'}</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-xs text-slate-400 mb-1">MS 2</div>
                                        <div class="text-lg font-bold text-white">${match.odds["2"] || '-'}</div>
                                    </div>
                                </div>
                            </div>
                        `;
                        
                        container.innerHTML += html;
                    });
                }
            }
        }
    </script>
</body>
</html>
